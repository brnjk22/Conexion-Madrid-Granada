name: laliga-leafspine
mgmt:
  network: eth0
  ipv4-subnet: 20.0.0.0/28
topology:
  nodes:
    # Spine Switches
    s1:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:1.0.0
      startup-config: Configs/Switches/Spine1.txt.partial
    s2:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:1.0.0
      startup-config: Configs/Switches/Spine2.txt.partial

    # Leaf Switches
    l1:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:L2-1.0.0
      startup-config: Configs/Switches/L1.txt.partial
      type: l2
    l2:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:L2-1.0.0
      startup-config: Configs/Switches/L2.txt.partial
      type: l2
    l3:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:L2-1.0.0
      startup-config: Configs/Switches/L3.txt.partial
      type: l2
    l4:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:L2-1.0.0
      startup-config: Configs/Switches/L4.txt.partial
      type: l2
    l5:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:L2-1.0.0
      startup-config: Configs/Switches/L5.txt.partial
      type: l2

    # Routers internos y externos
    r1:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:1.0.0
      startup-config: Configs/Routers/R1.txt.partial
    r2:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:1.0.0
      startup-config: Configs/Routers/R2.txt.partial
    r3:
      kind: cisco_iol
      image: vrnetlab/cisco_iol:1.0.0
      startup-config: Configs/Routers/R3.txt.partial

    # Firewall (Linux o personalizado)
    fw:
      kind: fortinet_fortigate
      image: vrnetlab/vr-fortios:fortios
      startup-config: Configs/Firewall/fw.txt.partial
      ports:
        - "8080:80"
        - "8443:443"

    #Hosts
    host_web:
      kind: linux
      image: ubuntu:latest
      network-mode: none
      startup-config: Configs/Hosts/host_web.txt.partial
    host_sri:
      kind: linux
      image: ubuntu:latest
      network-mode: none
      startup-config: Configs/Hosts/host_sri.txt.partial
    host_corp:
      kind: linux
      image: ubuntu:latest
      network-mode: none
      startup-config: Configs/Hosts/host_corp.txt.partial
    host_printer:
      kind: linux
      image: ubuntu:latest
      network-mode: none
      startup-config: Configs/Hosts/host_printer.txt.partial
    host_it:
      kind: linux
      image: ubuntu:latest
      network-mode: none
      startup-config: Configs/Hosts/host_it.txt.partial

  links:
    # Spine a los leaf
    - endpoints: ["s1:e0/1", "l1:e0/1"]
    - endpoints: ["s1:e0/2", "l2:e0/1"]
    - endpoints: ["s1:e0/3", "l3:e0/1"]
    - endpoints: ["s1:e1/0", "l4:e0/1"]
    - endpoints: ["s1:e1/1", "l5:e0/1"]

    - endpoints: ["s2:e0/1", "l1:e0/2"]
    - endpoints: ["s2:e0/2", "l2:e0/2"]
    - endpoints: ["s2:e0/3", "l3:e0/2"]
    - endpoints: ["s2:e1/0", "l4:e0/2"]
    - endpoints: ["s2:e1/1", "l5:e0/2"]

    # R1 conectado a L1
    - endpoints: ["r1:e0/1", "l1:e0/3"]
    # R1 conectado a L2
    - endpoints: ["r1:e0/2", "l2:e0/3"]

    # R2 conectado a L1
    - endpoints: ["r2:e0/1", "l1:e1/0"]
    # R2 conectado a L2
    - endpoints: ["r2:e0/2", "l2:e1/0"]

    # Firewall conectado a L2 (lado interno)
    # Firewall conectado a R3 (lado externo)
    # Firewall conectado a L1 (lado interno)
    - endpoints: ["fw:eth1", "l2:e1/1"]
    - endpoints: ["fw:eth2", "r3:e0/1"]
    - endpoints: ["fw:eth3", "l1:e1/1"]

    # L3 conectado a WEB y SRI (VLAN 20)
    - endpoints: ["l3:e0/3", "host_web:eth0"]
    - endpoints: ["l3:e1/0", "host_sri:eth0"]

    # L4 conectado a CORP (VLAN 30)
    - endpoints: ["l4:e0/3", "host_corp:eth0"]
    # L4 conectado a PRINTER (VLAN 40)
    - endpoints: ["l4:e1/0", "host_printer:eth1"]

    # L5 conectado a PRINTER (VLAN 40) y IT-USERS (VLAN 50)
    - endpoints: ["l5:e0/3", "host_printer:eth0"]
    - endpoints: ["l5:e1/0", "host_it:eth0"]